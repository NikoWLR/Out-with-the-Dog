
<html>

<head>

    <title>Out with the Dog</title>
    <meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!--stylesheets for lealfet, site and google fonts-->

    <link rel="stylesheet"href="https://fonts.googleapis.com/css?family=Comfortaa">
    <link rel="stylesheet"href="https://fonts.googleapis.com/css?family=Quicksand">
    <link rel="stylesheet" href="leaflet.css" />
    <link rel="stylesheet" href="style.css" />

    <!--External scripts and plugins #TODO!: Make as local as possible-->
    <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js" 
    integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA==" crossorigin="">
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="Plugins/leaflet.ajax.min.js" type="text/javascript" ></script>
    <script src="routing/dist/leaflet-routing-machine.js"></script>

    <script src="GeoJson/Koirapuistot.geojson.js"></script>
    <script src="GeoJson/polut.geojson.js"></script>
    <script src="GeoJson/digitie.geojson.js"></script>

    <!--GeoLocation plugin css-->
    <script src="https://cdn.jsdelivr.net/npm/leaflet.locatecontrol/dist/L.Control.Locate.min.js" charset="utf-8"></script>
    <link rel="stylesheet" href="routing/dist/leaflet-routing-machine.css" />
    <link rel="stylesheet" href="index.css" />
    <!--Routing plugin css-->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
</head>

<body>
    <div class="container"> <!--Flexbox container*-->
    <div id ="map"> <!--Contains the map itself-->

      <!--Scripts for the routing engine-->
      
      <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>
      <script src="routing/examples/Control.Geocoder.js"></script>
      <script src="routing/examples/config.js"></script>
      <script src="routing/examples/"></script>
      <script src="routing/dist/leaflet-routing-machine.js"></script>
      <script src="require.js"></script>
      <script src="bundle.js"></script>


<!--Start of the JavaScript. Pity thee who dare enter-->        


<script>

  function clickerTest() {
    map.panTo(new L.LatLng(60.4472761, 22.2968824));
  }

//click button to zoom to marker      
  $('parkbutton').on('click', function(){
      // parse lat and lng from the divs data attribute
      var latlng = $(this).data().point.split(',');
      var lat = latlng[0].trim();
      var lng = latlng[1].trim();
      var zoom = 10;

    // set the view
    map.panTo([lat, lng], zoom);
  })

  
//onEachFeature function for the dog park data
  function onEachFeature(feature, layer) {
  var popupContent = "- "+feature.properties.Id +"<br>"+ "- "+feature.properties.Koko;
  if (feature.properties && feature.properties.popupContent) {
    popupContent += feature.properties.popupContent;
  }
  layer.bindPopup(popupContent);
}

    //Defines the map itself 
  var map = L.map('map').setView([60.4518, 22.2666], 12);

    //defines the map tiles
  var tiles = L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4NXVycTA2emYycXBndHRqcmZ3N3gifQ.rJcFIG214AriISLbB6B5aw', {
    maxZoom: 18,
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, ' +
        'Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
    id: 'mapbox/streets-v11',
    tileSize: 512,
    zoomOffset: -1
}).addTo(map);

//adds location button
//var lc = L.control.locate().addTo(map);
// locates user on page load
//lc.start();

//Defines the markers for the dog parks.
var DogIcon = L.icon({
    iconUrl: 'Icons/DogPark_1.png',
    shadowUrl: '',
    iconSize:     [28, 55], // size of the icon
    //shadowSize:   [50, 64], // size of the shadow
    iconAnchor:   [13, 55], // point of the icon which will correspond to marker's location
    shadowAnchor: [4, 62],  // the same for the shadow
    popupAnchor:  [0, -50] // point from which the popup should open relative to the iconAnchor
});

//adds dog parks to map
var doggoparks = new L.GeoJSON(geojsonObject, {
  pointToLayer: function (feature, latlng) {
      return L.marker(latlng, {icon:DogIcon});
      return L.point(latlng); // The style
    },  onEachFeature: onEachFeature
    
}).addTo(map)

//Custom markers by Niclas (Dog beaches etc)
var ExampleMarker = L.marker([51.5, -0.09], {icon:DogIcon}).addTo(map); //Esimerkki oman markerin tekemisestä
var ExampleMarker = L.marker([60.425599 ,22.0972503], {icon:DogIcon}).addTo(map); // Saarronniemen koiraranta
var ExampleMarker = L.marker([60.425766,22.096746], {icon:DogIcon}).addTo(map); // Saarronniemen koirapuisto 
var ExampleMarker = L.marker([60.4203257,22.2508475], {icon:DogIcon}).addTo(map); //  Uittamon koiraranta 

//adds roads to map
var digitie = new L.GeoJSON(digitie, {
})

//adds paths to map
var kupittaaPolut = new L.GeoJSON(kupittaaPolut, {
}).addTo(map)

//Start of GeoJson routing hell



//End  of GeoJson routing hell


//Leaflet Routing Enfine stuff here.
var killmenow = L.routing.control(L.extend(window.lrmConfig, {
	waypoints: [
		L.latLng(60.454628, 22.303445),
		L.latLng(60.445611, 22.289936)
	],
	geocoder: L.Control.Geocoder.nominatim(),
	routeWhileDragging: true,
	reverseWaypoints: true,
	showAlternatives: true,
	altLineOptions: {
		styles: [
			{color: 'black', opacity: 0.15, weight: 9},
			{color: 'white', opacity: 0.8, weight: 6},
			{color: 'blue', opacity: 0.5, weight: 2}
		]
	}
})).addTo(map);

L.Routing.errorControl(control).addTo(map);

//add a starting point. TESTING ONLY BC MY GEOLOCATION IS BORKED
var start = L.point([60.454628, 22.303445]);

//add a end point. TESTING ONLY BC MY GEOLOCATION IS BORKED
var end = L.point([60.445611, 22.299636]);

var PathFinder = require('geojson-path-finder'),
    geojson = require('GeoJson/digitiePathing.json');

var pathFinder = new PathFinder(geojson);

var path = pathFinder.findPath(start, end).addTo(map);

</script> 

    

</div> <!--End of map & body divs-->
</div>



<div id="parkmenu", class="example">     <!-- menu for choosing nearby parks, mainly for looks atm-->
  <h1>Out with the Dog</h1>
  <div id ="parkbutton", onclick = "clickerTest()">
      <div id = "parkimage">
      </div>
    <h2>Kupittaan koirapuisto</h2>
    <p>2km from location</p>
  </div>
  <div id ="parkbutton", onclick="clickerTest()">
    <div id = "parkimage">
    </div>
    <h2>Hirvensalon koirapuisto</h2>
  </div>
  <div id ="parkbutton">
    <div id = "parkimage">
    </div>
    <h2>Härkähaan koira-aitaus</h2>
  </div>
  <div id ="parkbutton">
    <div id = "parkimage">
    </div>
    <h2>Piikkiön koirapuisto</h2>
  </div>
  <div id ="parkbutton">
    <div id = "parkimage">
    </div>
    <h2>Iso-Heikkilän koira-aitaus</h2>
  </div>
  <div id ="parkbutton">
    <div id = "parkimage">
    </div>
    <h2>Lausteen Koirapuisto</h2>
  </div>
  <div id ="parkbutton">
    <div id = "parkimage">
    </div>
    <h2>Nummenrannan koira-aitaus</h2>
  </div>
  <div id ="parkbutton">
    <div id = "parkimage">
    </div>
    <h2>Marjavuoren koira-aitaus</h2>
  </div>
  <div id ="parkbutton">
    <div id = "parkimage">
    </div>
    <h2>LRpuiston koira-aitaus</h2>
  </div>
  <div id ="parkbutton">
    <div id = "parkimage">
    </div>
    <h2>Park data go here</h2>
  </div>
  <div id ="parkbutton", onclick = "clickerTest()">
    <div id = "parkimage">
    </div>
  <h2>Kupittaan koirapuisto</h2>
</div>
<div id ="parkbutton", onclick="clickerTest()">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
<div id ="parkbutton">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
<div id ="parkbutton">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
<div id ="parkbutton">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
<div id ="parkbutton">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
<div id ="parkbutton">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
<div id ="parkbutton">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
<div id ="parkbutton">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
<div id ="parkbutton">
  <div id = "parkimage">
  </div>
  <h2>Park data go here</h2>
</div>
</div>
</body>
<footer></footer>
</html>